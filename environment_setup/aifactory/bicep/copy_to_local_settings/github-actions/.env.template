# Once: Github info
GITHUB_USERNAME="<todo>" # <mandatory>GitHub username or org<default><todo>
GITHUB_USE_SSH="false" # <optional>Use SSH for git operations<default>false<keep-as-is> <otherwise> true, use SSH instead of HTTPS.
GITHUB_TEMPLATE_REPO="azure/enterprise-scale-aifactory" # <optional>GitHub template repository<default>azure/enterprise-scale-aifactory<keep-as-is> Leave as-is if BYO repo.
GITHUB_NEW_REPO="<todo>/<todo>azure-enterprise-scale-aifactory-001" # <mandatory>New GitHub repository path<default><todo>/<todo>azure-enterprise-scale-aifactory-001<ensure> format: <org>/<repo-name>.
GITHUB_NEW_REPO_VISIBILITY="public" # <optional>New repository visibility<default>public<keep-as-is> <otherwise> private or internal.
TENANT_ID="<todo>" # <mandatory>Azure tenant ID<default><todo>_TenantId<ensure> find in Azure Portal > Entra ID > Overview (Directory ID).
TENANT_AZUREML_OID="<todo>" # <mandatory>Azure ML service principal OID<default><todo>_ObjectID<ensure> find in Entra ID as 'Azure Machine Learning' app (AppId: 0736f41a-0425-4b46-bdb5-1563eff02385). <otherwise> optional if ENABLE_AI_FOUNDRY:'false'.

# Once: AI Factory - Globals (Configure once)
AIFACTORY_LOCATION="eastus2" # <mandatory>Azure region<default>eastus2 Main Azure region for AI Factory.
AIFACTORY_LOCATION_SHORT="eus2" # <mandatory>Region short name<default>eus2
ADMIN_AISEARCH_TIER="basic" # <mandatory>AI Search SKU tier<default>basic<ensure> 'free' is not allowed when using private endpoints. ['free','basic','standard','standard2','standard3','storage_optimized_l1','storage_optimized_l2']
AISEARCH_SEMANTIC_TIER="free" # <mandatory>Semantic search tier<default>free ['disabled','free','standard']
AIFACTORY_PREFIX="acme-ai" # <optional>AI Factory resource group prefix<default>mrvel-1-<keep-as-is> Max 6 chars. <otherwise> set your company prefix, e.g. 'acme-ai-', 'contoso-'.
AIFACTORY_SUFFIX="-001" # <mandatory>AI Factory scaleset suffix<default>-001<keep-as-is> For 1st scaleset. <otherwise> increment to '-002', '-003' for additional scalesets.
LAKE_PREFIX="xxxyyy" # <optional>Data lake storage name prefix<default>mrvel<keep-as-is> Max 8 characters.
USE_COMMON_ACR_FOR_PROJECTS="true" # <optional>Use shared ACR across projects<default>true<keep-as-is> <otherwise> false, each project gets its own ACR (higher cost).
AIFACTORY_COMMON_ONLY_DEV_ENVIRONMENT="true" # <optional>Create common-DEV environment only<default>true<keep-as-is> <otherwise> false, creates Dev, Stage, Prod environments in Azure.
AIFACTORY_SEEDING_KEYVAULT_SUBSCRIPTION_ID="<todo>" # <mandatory>DEV seeding KV subscription ID<default><todo>_SubID<ensure> subscription where the DEV seeding Key Vault resides.
AIFACTORY_SEEDING_KEYVAULT_NAME="kv-seeding-sdc-001<todo>" # <mandatory>DEV seeding KV name<default><todo>_Name_Dev<ensure> Key Vault name storing secrets mapped to PROJECT_SERVICE_PRINCIPAL_KV_S_NAME_APPID.
AIFACTORY_SEEDING_KEYVAULT_RG="rg-seeding-sdc-001<todo>" # <mandatory>DEV seeding KV resource group<default><todo>_ResourceGroup_DEV<ensure> resource group where the DEV seeding Key Vault resides.
COMMON_SERVICE_PRINCIPAL_KV_S_NAME_APPID="esml-common-bicep-sp-id" # <mandatory>Seeding KV secret name for common SP App ID<default>esml-common-sp-id<ensure> name matches the secret in your Seeding Keyvault.
COMMON_SERVICE_PRINCIPAL_KV_S_NAME_SECRET="esml-common-bicep-sp-secret" # <mandatory>Seeding KV secret name for common SP secret<default>esml-common-sp-secret<ensure> name matches the secret in your Seeding Keyvault.
KEYVAULT_SOFT_DELETE="7" # <optional>Key Vault soft delete days<default>7<keep-as-is> <mandatory> if CMK:'true' (purge protection required). <otherwise> 90 days recommended; 0 to disable.
USE_AD_GROUPS="true" # <optional>Use AD groups for project members<default>true<keep-as-is> <otherwise> false, use individual ObjectIDs and simple mode Personas.
ADMIN_USERNAME="esmladmin" # <optional>VM admin username<default>esmladmin<keep-as-is>
ADMIN_HYBRID_BENEFIT="true" # <optional>Azure Hybrid Benefit for VMs<default>false <otherwise> true, if you have eligible Windows licenses with Software Assurance (pay-as-you-go avoided).

# Once / per scale set: AI Factory - Environments: Dev, Stage, Prod (Configure once, or per AI Factory scale set)
DEV_SUBSCRIPTION_ID="<todo>" # <mandatory>DEV subscription ID<default><todo>_SubID
STAGE_SUBSCRIPTION_ID="<todo>" # <optional>STAGE subscription ID<default><todo>_SubID<recommended> separate subscription from DEV. <otherwise> can reuse DEV_SUBSCRIPTION_ID.
PROD_SUBSCRIPTION_ID="<todo>" # <optional>PROD subscription ID<default><todo>_SubID<recommended> separate subscription from DEV. <otherwise> can reuse DEV_SUBSCRIPTION_ID.
DEV_CIDR_RANGE="61" # <mandatory>DEV vNet CIDR substitution value<default>61<keep-as-is> Replaces XX in CIDR templates (e.g. 172.16.61.0/26). <otherwise> choose 0-255 not conflicting with other environments.
STAGE_CIDR_RANGE="62" # <mandatory>STAGE vNet CIDR substitution value<default>62<keep-as-is> Replaces XX in CIDR templates (e.g. 172.16.62.0/26).
PROD_CIDR_RANGE="63" # <mandatory>PROD vNet CIDR substitution value<default>63<keep-as-is> Replaces XX in CIDR templates (e.g. 172.16.63.0/26).

# Sometimes: UPDATE AIFactory: If you want to upgrade the AIFactory. E.g. if you go from submodule 'release/v1.20' to 'release/v1.21' your AIFactory will be upgraded to 1.21 (add new private dns zones, etc)
AIFACTORY_VERSION_MAJOR="1" # <optional>AI Factory major version<default>1<keep-as-is> Used to determine which bicep files to use.
AIFACTORY_VERSION_MINOR="24" # <optional>AI Factory minor version<default>24<keep-as-is> 2025-09-20: 24 = release/v1.24
AIFACTORY_BRANCH_CHOSEN="release/v1.24" # <optional>Submodule release branch<default>release/v1.24<keep-as-is>
TAG_COSTCETER_COMMON="9999" # <optional>Common cost center tag<default>9999<keep-as-is> Metadata for Resource group cost tracking.
TAG_REPOSITORY="aifactory" # <optional>Repository name tag<default>aifactory<keep-as-is>
TAG_REPOSITORY_BRANCH="aifactory-001" # <optional>Repository branch tag<default>aifactory-001<keep-as-is> <otherwise> per scaleset 'aifactory-002', or per project 'aifactory-001/project001-main'.
TAGS='{"CostCenter":"9999","Description":"AI Factory common","AIF-Repo":"aifactory","AIF-Branch":"aifactory-001","AIF-Version":"1.24","AIF-Submodule-Chosen-Branch":"release/v1.24","AIF-Scaleset":"-001","AIF-Project Owners":"","AIFactory project":"001","AIF-Networking":"true,true,true","AIF-enableAIFactoryCreatedDefaultProjectForAIFv2":"true","AIF-disableAgentNetworkInjection":"false","AIF-byoASEv3":"false","AIF-BYO_subnets":"false"}' # <optional>Common-level Azure resource tags (JSON)<default>{'CostCenter':'9999',...}<keep-as-is> Update CostCenter, Description, and branch values to match your deployment.

# --- COMMON CONFIGURATION START ---
AZURE_MACHINELEARNING_SP_OID="<todo>" # <mandatory>Azure ML service principal OID<default><todo>_ObjectID<ensure> find in Entra ID as 'Azure Machine Learning' app. <otherwise> optional if ENABLE_AI_FOUNDRY:'false'.
DATABRICKS_OID="<todo>" # <optional>Databricks object ID<default><todo>_ObjectID<mandatory> if ENABLE_DATABRICKS:'true' <ensure> find Databricks object ID in Entra ID.
ENABLE_AMPLS="false" # <optional>Enable AMPLS in Hub<default>false<keep-as-is> <otherwise> true, AMPLS created in Hub subscription; AppInsights in private/private mode.
#COMMON RG: SERVICES
ADD_BASTION_HOST="false" # <optional>Add Bastion Host in common RG<default>false<keep-as-is>
ENABLE_ADMIN_VM="false" # <optional>Enable Admin VM in common RG<default>false<keep-as-is>
# HUB vs STANDALONE
CENTRAL_DNS_ZONE_BY_POLICY_IN_HUB="false" # <optional>Centralized DNS via Hub policy<default>false<keep-as-is> <otherwise> true, uses central private DNS zones in HUB resource group managed by Azure Policy.
PRIV_DNS_SUBSCRIPTION_PARAM="<todo>" # <optional>Hub DNS subscription ID<default><todo>_SubscriptionID<mandatory> if CENTRAL_DNS_ZONE_BY_POLICY_IN_HUB:'true' <ensure> Hub connectivity subscription ID.
PRIV_DNS_RESOURCE_GROUP_PARAM="<todo>" # <optional>Hub DNS resource group<default><todo>_ResourceGroup_name<mandatory> if CENTRAL_DNS_ZONE_BY_POLICY_IN_HUB:'true' <ensure> Hub connectivity resource group.
# Common Service principal
INPUT_COMMON_SPID_KEY="<todo>esml-common-sp-id" # <mandatory>Seeding KV secret name for common SP App ID<default>esml-common-sp-id<ensure> name matches the secret in your Seeding Keyvault.
INPUT_COMMON_SP_SECRET_KEY="<todo>esml-common-sp-secret" # <mandatory>Seeding KV secret name for common SP secret<default>esml-common-sp-secret<ensure> name matches the secret in your Seeding Keyvault.
COMMON_SERVICE_PRINCIPLE_OID_KEY="<todo>esml-common-sp-oid" # <mandatory>Seeding KV secret name for common SP OID<default>esml-common-sp-oid<ensure> name matches the secret in your Seeding Keyvault.
# NETWORKING MODES
ALLOW_PUBLIC_ACCESS_WHEN_BEHINDVNET="true" # <optional>Public UI access when behind vNet<default>true<recommended> false to enable fully private networking.
ENABLE_PUBLIC_GENAI_ACCESS="true" # <optional>Public GenAI access (control plane)<default>true<recommended> false to enable fully private networking.
ENABLE_PUBLIC_ACCESS_WITH_PERIMETER="true" # <optional>Public access with network perimeter<default>true<recommended> false to enable fully private networking.
# MONITORING
DIAGNOSTIC_SETTING_LEVEL="gold" # <optional>Diagnostics level<default>gold<keep-as-is> <otherwise> silver or bronze for less verbose (lower cost) logging.
# --- COMMON CONFIGURATION END ---

# PRE PROJECT ############################# PRE SETUP of a PROJECT - UPDATE THIS
PROJECT_NUMBER="001" # <mandatory>Project number<default>001<keep-as-is> For 1st project. <otherwise> increment to '002', '003', etc.
PROJECT_MEMBERS="<todo>_object_id" # <mandatory>Project team Entra ID object ID(s)<default><todo>_EntraID_ObjectID<ensure> comma-separated ObjectIDs of users or AD groups (when USE_AD_GROUPS:'true').
PROJECT_MEMBERS_EMAILS="<todo>_EntraID-Security-Group-Name" # <optional>Project team contact email or group name<default><todo>_EntraID-Security-Group-Name<recommended> set for better project tracking.
PROJECT_MEMBERS_IP_ADDRESS="-" # <optional>Project UI IP allowlist<default>-<mandatory> if using IP-whitelisting networking mode <ensure> comma-separated IPv4 addresses without spaces.
TAG_COSTCENTER="1234" # <optional>Project cost center tag<default>1234<keep-as-is> Metadata for per-project cost tracking.
TAGS_PROJECT='{"CostCenter":"1234","Description":"RAG Chat 1","AIF-Branch":"aifactory-001/project001","AIF-Scaleset":"-001","AIF-Environment":"dev","AIF-Project Owners":"","AIFactory project":"001","AIF-Networking":"true,true,true","AIF-enableAIFactoryCreatedDefaultProjectForAIFv2":"true","AIF-disableAgentNetworkInjection":"false","AIF-byoASEv3":"false","AIF-BYO_subnets":"false"}' # <optional>Project-level Azure resource tags (JSON)<default>{'CostCenter':'1234',...}<keep-as-is> Update CostCenter, Description, and project values to match your project.
SERVICE_SETTING_DEPLOY_PROJECT_VM="false" # <optional>Deploy VM in project resource group<default>false<keep-as-is> <otherwise> true, deploy a jumpbox VM for use with Azure Bastion.
### PRE PROJECT END ############################# E

# OPTIONAL if running twice ############################# POST SETUP of a PROJECT - UPDATE THIS if you want to skip networking
RUN_JOB1_NETWORKING="true" # <mandatory>Run networking module<default>true<keep-as-is> true when creating or updating a project. <otherwise> false, to skip networking on service-only updates.

# Optional: These are used by the merged `infra-project.yml` workflow if present
ADMIN_COMMON_RESOURCE_SUFFIX="-001" # <optional>Common resources suffix<default>-001<keep-as-is> <otherwise> change to reprovision new services in the same common RG while keeping old ones.
ADMIN_PRJ_RESOURCE_SUFFIX="-001" # <optional>Project resources suffix<default>-001<keep-as-is> <otherwise> change to reprovision new services in the same project RG while keeping old ones.
DISABLE_WHITELISTING_FOR_BUILD_AGENTS="false" # <optional>Disable runner IP whitelisting<default>false<keep-as-is> <otherwise> true, skip whitelisting (use only if runner already has network access).
# POST SETUP - END

################################ OPTIONAL - START ################################

# OPTIONAL - Only change if you have different secret names in seeding keyvault (See PREREQUISITES in documentation)
PROJECT_SERVICE_PRINCIPAL_KV_S_NAME_APPID="<todo>esml-project001-sp-id" # <mandatory>Project SP App ID secret name in seeding KV<default>esml-project001-sp-id<ensure> name matches the secret in your Seeding Keyvault.
PROJECT_SERVICE_PRINCIPAL_KV_S_NAME_OID="<todo>esml-project001-sp-oid"  # <mandatory>Project SP OID secret name in seeding KV<default>esml-project001-sp-oid<ensure> name matches the secret in your Seeding Keyvault.
PROJECT_SERVICE_PRINCIPAL_KV_S_NAME_S="<todo>esml-project001-sp-secret" # <mandatory>Project SP secret name in seeding KV<default>esml-project001-sp-secret<ensure> name matches the secret in your Seeding Keyvault.
PROJECT_TYPE="all" # <optional>Project type<default>all<keep-as-is> Not used anymore. Leave as is.

# OPTIONAL - Bring your own subnets (BYO_subnets=true) - optional (leave empty string to disable).  Otherwise, leave it empty and the pipeline will create new subnets, based on the CIDR in 12-esml-cmn-parameters.json
BYO_SUBNETS="false" # <optional>Bring your own subnets<default>false<keep-as-is> <otherwise> true, uses pre-existing subnets defined by the BYO subnet variables below.
DEV_NETWORK_ENV="dev-" # <optional>DEV environment prefix for BYO subnets<default>dev-<keep-as-is> <otherwise> set to empty string if not using environment-prefixed naming.
STAGE_NETWORK_ENV="stage-" # <optional>STAGE environment prefix for BYO subnets<default>tst2-<keep-as-is> <otherwise> 'tst-', 'test-', or empty string.
PROD_NETWORK_ENV="prod-" # <optional>PROD environment prefix for BYO subnets<default>prd-<keep-as-is> <otherwise> 'pr-', or empty string.

########### OPTIONAL - Enable flags (services + platform) ############
# These are the main feature flags used to enable/disable services in v1.23+ (mirrors Azure DevOps variables.yaml)

# === Defender for Cloud: Defender for AI ===
ENABLE_DEFENDER_FOR_AI_SUB_LEVEL="false"       # <optional>Defender for AI at subscription level<default>false<keep-as-is> Subscription-level Microsoft Defender for AI protection.
ENABLE_DEFENDER_FOR_AI_RESOURCE_LEVEL="false"  # <optional>Defender for AI at resource level<default>false<keep-as-is> Per-resource Microsoft Defender for AI protection.

# === CMK/CMEK - Customer Managed Key for encryption at rest ===
CMK="false"               # <optional>Customer Managed Key encryption<default>false<keep-as-is> <otherwise> true enables CMEK where supported. Requires KEYVAULT_SOFT_DELETE > 7 days.
CMK_KEY_NAME="<todo>aifactory-cmk-key"  # <optional>CMK key name in seeding KV<default><todo>aifactory-cmk-key<mandatory> if CMK:'true' <ensure> key must exist in seeding Key Vault.
CMK_KEY_VERSION=""         # <optional>CMK key version<default>''<keep-as-is> Leave empty to always use the latest key version.

# === Key Vault RBAC update ===
UPDATE_KEYVAULT_RBAC="false"  # <optional>Update Key Vault RBAC<default>false<keep-as-is> <otherwise> true enables updating KV RBAC by rerunning the pipeline.

# === RBAC: Contributor role override ===
BYO_CONTRIBUTOR_ROLE_ID="b24988ac-6180-42a0-ab88-20f7382dd24c" # <optional>Contributor role ID<default>b24988ac-6180-42a0-ab88-20f7382dd24c<keep-as-is> Built-in Contributor role ID. <otherwise> provide a custom role ID for finer-grained access control.
# RBAC MODES - PROJECTS
DISABLE_CONTRIBUTOR_ACCESS_FORUSERS="false" # <optional>Disable Contributor for project users<default>false<recommended> true, restrict direct Contributor for better governance.
DISABLE_RBAC_ADMIN_ON_RG_FORUSERS="false" # <optional>Disable RBAC Admin on RG for project users<default>true<recommended> true, restrict RBAC Admin on resource group for better governance.

# === Complete mode vs Incremental mode ===
ENABLE_DELETE_FOR_DISABLED_RESOURCES="true"  # <optional>Delete disabled services<default>true<keep-as-is> true, delete resources that exist but are disabled (ENABLE_* flag = false). <otherwise> false, keep all existing resources.
DELETE_ALL_SERVICES_FOR_PROJECT="false"        # <optional>Delete all project services<default>false<keep-as-is> <otherwise> true, delete ALL services in the project RG (except KV, Storage, AppInsights) before redeploy.

# === AI Foundry / AI Services ===
ENABLE_AI_FOUNDRY="true"            # <mandatory>Enable AI Foundry<default>true<recommended> enterprise-grade private networking, BYOvNet.
UPDATE_AI_FOUNDRY="false"           # <optional>Update AI Foundry properties<default>false<keep-as-is> <otherwise> true, update existing Foundry properties and RBAC.
ADD_AI_FOUNDRY="false"              # <optional>Add new AI Foundry instance<default>false<keep-as-is> <otherwise> true, add new Foundry even if one already exists.
ENABLE_FOUNDRY_CAPHOST="false"       # <optional>AI Foundry capability host<default>true<recommended> true, enables private agents (history/threads stored in your subscription).
FOUNDRY_DEPLOYMENT_TYPE="1"          # <optional>AI Foundry deployment type<default>2<keep-as-is> 1=PG, 2=AVM, 3=Both (fallback).
ENABLE_AIFACTORY_CREATED_DEFAULT_PROJECT_FOR_AIFV2="true" # <optional>AI Factory default project for AIFv2<default>true<keep-as-is>
DISABLE_AGENT_NETWORK_INJECTION="false" # <optional>Disable agent network injection<default>false<keep-as-is> <otherwise> true, disables network injection. Requires Class B/C network ranges (172.16/12 or 192.168/16).

# === Data & Machine Learning ===
ENABLE_DATAFACTORY="false" # <optional>Enable Azure Data Factory<default>false<keep-as-is>
ENABLE_DATAFACTORY_COMMON="false" # <optional>Enable Data Factory in common RG<default>false<keep-as-is>
ENABLE_AZURE_MACHINE_LEARNING="false" # <optional>Enable Azure Machine Learning<default>false<keep-as-is>
ADD_AZURE_MACHINE_LEARNING="false" # <optional>Add new Azure ML workspace<default>false<keep-as-is>

# === AKS for Azure ML ===
ENABLE_AKS_FOR_AZURE_ML="true" # <optional>Enable AKS for Azure ML inference<default>true<keep-as-is> <mandatory> if ENABLE_AZURE_MACHINE_LEARNING:'true'
AKS_OUTBOUND_TYPE="loadBalancer"      # <optional>AKS outbound network type<default>loadBalancer<keep-as-is> <otherwise> userDefinedRouting for firewall/UDR scenarios.
AKS_PRIVATE_DNS_ZONE="system"         # <optional>AKS private DNS zone<default>system<keep-as-is> <otherwise> none, or full resourceId of an existing private DNS zone.
AKS_AZURE_FIREWALL_PRIVATE_IP=""       # <optional>Azure Firewall private IP for AKS<default>''<mandatory> if AKS_OUTBOUND_TYPE:'userDefinedRouting'

ENABLE_DATABRICKS="false" # <optional>Enable Azure Databricks<default>false<keep-as-is>

# === Cognitive Services ===
ENABLE_AI_SEARCH="true" # <optional>Enable AI Search<default>true<keep-as-is>
ADD_AI_SEARCH="false"                  # <optional>Add new AI Search instance<default>false<keep-as-is> <otherwise> true, add new instance even if one exists.
ENABLE_AI_SEARCH_SHARED_PRIVATE_LINK="true" # <optional>Enable AI Search shared private link<default>true<keep-as-is>
ADMIN_AI_SEARCH_TIER="basic" # <mandatory>AI Search SKU tier<default>basic<ensure> 'free' is not allowed when using private endpoints. ['free','basic','standard','standard2','standard3','storage_optimized_l1','storage_optimized_l2']
ADMIN_SEMANTIC_SEARCH_TIER="free" # <mandatory>Semantic search tier<default>free ['disabled','free','standard']

ENABLE_AZURE_OPENAI="false" # <optional>Enable Azure OpenAI standalone account<default>false<keep-as-is> <otherwise> true, deploy a standalone Azure OpenAI resource (separate from AI Foundry).
ENABLE_AZURE_AI_VISION="false" # <optional>Enable Azure AI Vision<default>false<keep-as-is>
ENABLE_AZURE_SPEECH="false" # <optional>Enable Azure AI Speech<default>false<keep-as-is>
ENABLE_AI_DOC_INTELLIGENCE="false" # <optional>Enable Azure AI Document Intelligence<default>false<keep-as-is>
ENABLE_BING="false" # <optional>Enable Bing Search<default>false<keep-as-is>
ENABLE_BING_CUSTOM_SEARCH="false" # <optional>Enable Bing Custom Search<default>false<keep-as-is>
BING_CUSTOM_SEARCH_SKU="G2" # <optional>Bing Custom Search SKU<default>G2<keep-as-is>
ENABLE_CONTENT_SAFETY="false" # <optional>Enable Azure AI Content Safety<default>false<keep-as-is>

# === Databases ===
ENABLE_COSMOS_DB="false" # <optional>Enable Cosmos DB<default>false<keep-as-is>
COSMOS_KIND="GlobalDocumentDB"        # <optional>Cosmos DB kind<default>GlobalDocumentDB<keep-as-is> <otherwise> MongoDB.
ENABLE_POSTGRESQL="false" # <optional>Enable Azure PostgreSQL Flexible Server<default>false<keep-as-is>
POSTGRES_ADMIN_EMAILS="" # <optional>PostgreSQL administrator email(s)<default>''<mandatory> if ENABLE_POSTGRESQL:'true' <ensure> single email address for the PostgreSQL administrator.
ENABLE_REDIS_CACHE="false" # <optional>Enable Azure Cache for Redis<default>false<keep-as-is>
ENABLE_SQL_DATABASE="false" # <optional>Enable Azure SQL Database<default>false<keep-as-is>

# === WebApp / Functions ===
ENABLE_FUNCTION="false" # <optional>Enable Azure Functions<default>false<keep-as-is>
FUNCTION_RUNTIME="dotnet" # <optional>Functions runtime stack<default>dotnet<keep-as-is> <otherwise> python, node, java.
FUNCTION_VERSION="v7.0" # <optional>Functions runtime version<default>v7.0<keep-as-is>

ENABLE_WEBAPP="false" # <optional>Enable Azure Web App<default>false<keep-as-is>
WEBAPP_RUNTIME="python" # <optional>Web App runtime stack<default>python<keep-as-is> <otherwise> dotnet, node, java.
WEBAPP_RUNTIME_VERSION="3.11" # <optional>Web App runtime version<default>3.11<keep-as-is>
ASE_SKU="IsolatedV2" # <optional>App Service Environment SKU<default>IsolatedV2<keep-as-is>
ASE_SKU_CODE="I1v2" # <optional>ASE SKU code<default>I1v2<keep-as-is>
ASE_SKU_WORKERS="1" # <optional>ASE number of workers<default>1<keep-as-is>

# === Container Apps ===
ENABLE_CONTAINER_APPS="false" # <optional>Enable Azure Container Apps<default>false<keep-as-is>
ENABLE_APPINSIGHTS_DASHBOARD="false" # <optional>Enable Application Insights dashboard<default>false<keep-as-is>
ACA_W_REGISTRY_IMAGE="mcr.microsoft.com/azuredocs/containerapps-helloworld:latest" # <optional>Container Apps default registry image<default>mcr.microsoft.com/azuredocs/containerapps-helloworld:latest<keep-as-is>

# === Integration ===
ENABLE_LOGIC_APPS="false" # <optional>Enable Azure Logic Apps<default>false<keep-as-is>
ENABLE_EVENT_HUBS="false" # <optional>Enable Azure Event Hubs<default>false<keep-as-is>
ENABLE_BOT_SERVICE="true" # <optional>Enable Azure Bot Service<default>true<keep-as-is>
FOUNDRY_API_MANAGEMENT_RESOURCE_ID=""  # <optional>Existing APIM resource ID for AI Foundry integration<default>''<keep-as-is> Leave empty for no APIM integration. <otherwise> provide full resourceId of existing API Management instance.

# === Naming convention (BYO naming) ===
PROJECT_PREFIX="esml-"  # <optional>Project resource name prefix<default>esml-<keep-as-is>
PROJECT_SUFFIX="-rg"   # <optional>Project resource name suffix<default>-rg<keep-as-is>

# GENAI: Default Models to start with
DEPLOY_MODEL_GPT_X="false" # <optional>Deploy custom GPT-X model<default>false<keep-as-is> <otherwise> true, deploys the model defined in MODEL_GPTX_NAME.
MODEL_GPTX_NAME="gpt-5-mini" # <optional>Custom GPT-X model name<default>gpt-5-mini<keep-as-is>
MODEL_GPTX_VERSION="" # <optional>Custom GPT-X model version<default>''<keep-as-is> Leave empty to use the latest available version.
MODEL_GPTX_SKU="DataZoneStandard" # <optional>Custom GPT-X model SKU<default>DataZoneStandard<keep-as-is> ['Standard','DataZoneStandard','GlobalStandard']
MODEL_GPTX_CAPACITY="30" # <optional>Custom GPT-X model capacity (TPM in K)<default>30<keep-as-is> 30 = 30K tokens per minute.

DEPLOY_MODEL_TEXT_EMBEDDING_ADA_002="false" # <optional>Deploy text-embedding-ada-002<default>false<keep-as-is>
DEPLOY_MODEL_TEXT_EMBEDDING_3_LARGE="true" # <optional>Deploy text-embedding-3-large<default>true<keep-as-is>
DEPLOY_MODEL_TEXT_EMBEDDING_3_SMALL="false" # <optional>Deploy text-embedding-3-small<default>false<keep-as-is>
DEFAULT_EMBEDDING_CAPACITY="25" # <optional>Embedding model capacity (TPM in K)<default>25<keep-as-is>

DEPLOY_MODEL_GPT_4O_MINI="false" # <optional>Deploy GPT-4o-mini model<default>false<keep-as-is>
DEFAULT_GPT_4O_MINI_VERSION="2024-07-18" # <optional>GPT-4o-mini version<default>2024-07-18<keep-as-is> Note: version '2024-07-18' does not support Bing search grounding in Agents.

DEPLOY_MODEL_GPT_4O="true" # <optional>Deploy GPT-4o model<default>true<keep-as-is>
DEFAULT_GPT_4O_VERSION="2024-11-20" # <optional>GPT-4o version<default>2024-11-20<keep-as-is>

DEFAULT_GPT_CAPACITY="40" # <optional>GPT model capacity (TPM in K)<default>40<keep-as-is> 40 = 40K tokens per minute.
DEFAULT_MODEL_SKU="Standard"  # <optional>Default model deployment SKU<default>Standard<keep-as-is> ['Standard','DataZoneStandard','GlobalStandard']

# Change if you want to create new resources. Keeps old.
ADMIN_COMMON_RESOURCE_SUFFIX="-001" # <optional>Common resources suffix<default>-001<keep-as-is> <otherwise> change to reprovision new services in the same common RG while keeping old ones.
ADMIN_PRJ_RESOURCE_SUFFIX="-001" # <optional>Project resources suffix<default>-001<keep-as-is> <otherwise> change to reprovision new services in the same project RG while keeping old ones.
USE_COMMON_ACR_OVERRIDE="true" # <optional>Use shared ACR across projects (override)<default>true<keep-as-is>
ACR_IP_WHITELIST="" # <optional>ACR IP allowlist for selected networks<default>''<keep-as-is> comma-separated approved IPv4 addresses/ranges for ACR.
ACR_ADMIN_USER_ENABLED="false" # <optional>Enable ACR admin user<default>false<keep-as-is> <otherwise> true enables admin user; false is more secure.
ACR_DEDICATED="true" # <optional>Dedicated ACR (Premium only)<default>true<keep-as-is>
ACR_SKU="Premium" # <optional>ACR SKU<default>Premium<keep-as-is> Premium required for private endpoints or CMK.

# BASELINE (not BYO) for COMMON SUBNET NAMES - Change defaults if you like. Will be used regarding of BYOVnet or BYOsubnet
VNET_RESOURCE_GROUP_BASE="esml-common" # <optional>Common vNet resource group base name<default>esml-common<keep-as-is> Base name of the common vNet's resource group (used when not BYOvNet).
VNET_NAME_BASE="vnt-esmlcmn" # <optional>Common vNet base name<default>vnt-esmlcmn<keep-as-is> Base name of the common virtual network.
SUBNET_COMMON_BASE="snet-esml-cmn-001" # <optional>Common subnet base name<default>snet-esml-cmn-001<keep-as-is>
COMMON_VNET_CIDR="172.16.0.0/16" # <optional>Common vNet CIDR<default>172.16.0.0/16<keep-as-is>
COMMON_SUBNET_CIDR="172.16.XX.0/26" # <optional>Common subnet CIDR template<default>172.16.XX.0/26<keep-as-is> XX is replaced by the environment CIDR range value.
COMMON_SUBNET_SCORING_CIDR="172.16.XX.64/26" # <optional>Common scoring subnet CIDR template<default>172.16.XX.64/26<keep-as-is>
COMMON_PBI_SUBNET_NAME="snet-esml-cmn-pbi-001" # <optional>Power BI subnet name<default>snet-esml-cmn-pbi-001<keep-as-is>
COMMON_PBI_SUBNET_CIDR="172.16.XX.128/26" # <optional>Power BI subnet CIDR template<default>172.16.XX.128/26<keep-as-is>
COMMON_BASTION_SUBNET_NAME="AzureBastionSubnet" # <optional>Bastion subnet name<default>AzureBastionSubnet<keep-as-is> Must be exactly 'AzureBastionSubnet'.
COMMON_BASTION_SUBNET_CIDR="172.16.XX.192/26" # <optional>Bastion subnet CIDR template<default>172.16.XX.192/26<keep-as-is>

# BYO Overrides: Override AI Factory vanilla - BYOvNet, BYOsnet, BYOAse
VNET_RESOURCE_GROUP_PARAM="" # <optional>BYO vNet resource group<default>''<mandatory> if BYO_SUBNETS:'true' <ensure> resource group of the existing vNet.
VNET_NAME_FULL_PARAM="" # <optional>BYO vNet full name<default>''<mandatory> if BYO_SUBNETS:'true' <ensure> full name of the existing virtual network.
USE_COMMON_ACR_OVERRIDE="true" # <optional>Use shared ACR (BYO override)<default>true<keep-as-is>
SUBNET_COMMON="" # <optional>BYO common subnet name<default>''<mandatory> if BYO_SUBNETS:'true'
SUBNET_COMMON_SCORING="" # <optional>BYO common scoring subnet name<default>''<mandatory> if BYO_SUBNETS:'true'
SUBNET_COMMON_POWERBI_GW="" # <optional>BYO Power BI gateway subnet name<default>''<keep-as-is>
SUBNET_PROJ_GENAI="" # <optional>BYO GenAI project subnet name<default>''<mandatory> if BYO_SUBNETS:'true'
SUBNET_PROJ_AKS="" # <optional>BYO AKS project subnet name<default>''<mandatory> if ENABLE_AKS_FOR_AZURE_ML:'true' and BYO_SUBNETS:'true'
SUBNET_PROJ_AKS2="" # <optional>BYO AKS secondary project subnet name<default>''<keep-as-is>
SUBNET_PROJ_ACA="" # <optional>BYO Container Apps project subnet name<default>''<mandatory> if ENABLE_CONTAINER_APPS:'true' and BYO_SUBNETS:'true'
SUBNET_PROJ_ACA2="" # <optional>BYO Container Apps secondary project subnet name<default>''<keep-as-is>
SUBNET_PROJ_DATABRICKS_PUBLIC="" # <optional>BYO Databricks public subnet name<default>''<mandatory> if ENABLE_DATABRICKS:'true' and BYO_SUBNETS:'true'
SUBNET_PROJ_DATABRICKS_PRIVATE="" # <optional>BYO Databricks private subnet name<default>''<mandatory> if ENABLE_DATABRICKS:'true' and BYO_SUBNETS:'true'
BYO_ASEV3="false" # <optional>Bring your own ASEv3<default>false<keep-as-is> <otherwise> true, use a pre-existing App Service Environment v3.
BYO_ASE_FULL_RESOURCE_ID="/subscriptions/...<todo><todo_if_BYO_ASEV3_is_true>yourASEnameS2" # <optional>BYO ASEv3 full resource ID<default>/subscriptions/...<mandatory> if BYO_ASEV3:'true' <ensure> full resource ID of the existing ASEv3.
BYO_ASE_APP_SERVICE_PLAN_RESOURCE_ID="" # <optional>BYO App Service Plan resource ID<default>''<mandatory> if BYO_ASEV3:'true' and re-using an existing App Service Plan.

# GenAI-DEBUG - Dont touch: infra AIFactory core team only
DEBUG_DISABLE_05_BUILD_ACR_IMAGE="false" # <optional>Disable ACR image build step<default>false<keep-as-is> Cannot be disabled if ContainerApps is enabled (requires ACR networking with runner IP allowlist).
DEBUG_DISABLE_VALIDATION_TASKS="false" # <optional>Disable validation tasks<default>false<keep-as-is> <otherwise> true, skip subnet, submodule, and DNS checks.
DEBUG_DISABLE_61_FOUNDATION="false" # <optional>Disable step 61: Foundation<default>false<keep-as-is> Resource groups, UAMIs, VMs.
DEBUG_DISABLE_62_CORE_INFRASTRUCTURE="false" # <optional>Disable step 62: Core infrastructure<default>false<keep-as-is> Application Insights, Key Vault, Storage, ACR.
DEBUG_DISABLE_63_COGNITIVE_SERVICES="false" # <optional>Disable step 63: Cognitive Services<default>false<keep-as-is> AI Search, OpenAI Standalone, Vision, Speech.
DEBUG_DISABLE_64_DATABASES="false" # <optional>Disable step 64: Databases<default>false<keep-as-is> CosmosDB, SQL Database.
DEBUG_DISABLE_65_COMPUTE_SERVICES="false" # <optional>Disable step 65: Compute services<default>false<keep-as-is> Container Apps, WebApp, FunctionApp.
DEBUG_DISABLE_66_AI_PLATFORM="false" # <optional>Disable step 66: AI Platform<default>false<keep-as-is> AI Foundry Hub (V1) with default project and connections.
DEBUG_DISABLE_67_ML_PLATFORM="false" # <optional>Disable step 67: ML Platform<default>false<keep-as-is> Azure Machine Learning, Datafactory, Databricks.
DEBUG_DISABLE_68_INTEGRATION="false" # <optional>Disable step 68: Integration<default>false<keep-as-is> Logic Apps, Event Hubs.
DEBUG_DISABLE_69_AIFOUNDRY_2025="false" # <optional>Disable step 69: AI Foundry V2<default>false<keep-as-is> AI Foundry V2 including RBAC and default project (CosmosDB, Storage).
DEBUG_DISABLE_100_RBAC_SECURITY="false" # <optional>Disable step 100: RBAC & Security<default>false<keep-as-is> RBAC assignments for steps 61-99.
DEBUG_DISABLE_10_AIFACTORY_DASHBOARDS="true" # <optional>Disable AI Factory Dashboards step<default>true<keep-as-is>

# ENTRA ID SECURITY GROUPS - Object ID's (Create a new set of AD groups per project team. 001,002, etc)
# Tip of naming: Build a prefix based on [AIFactory prefix, suffix, locationSuffix and project number]) and add a persona unique suffix 'p001' that easily maps to the AI Factory persona prefixes.
GROUPS_PROJECT_MEMBERS_ESML="<aif001sdc_prj001_team_lead_p001>,<aif001sdc_prj001_team_member_ds_p002>,<aif001sdc_prj001_team_member_fend_p003>" # <mandatory>ESML project team Entra ID group OIDs<default><aif001sdc_prj001_team_lead_p001>,...<ensure> 3 comma-separated AD group ObjectIDs matching personas in PERSONAS_PROJECT_ESML.
GROUPS_PROJECT_MEMBERS_GENAI_1="<aif001sdc_prj002_team_lead_p011>,<aif001sdc_prj002_genai_team_member_aifoundry_p012>,<aif002sdc_prj001_genai_team_member_agentic_p013>,<aif001sdc_prj001_genai_team_member_dataops_p014>,<aif001sdc_prj001_team_member_fend_p015>" # <mandatory>GenAI-1 project team Entra ID group OIDs<default><aif001sdc_prj002_team_lead_p011>,...<ensure> 5 comma-separated AD group ObjectIDs matching personas in PERSONAS_PROJECT_GENAI_1.
GROUPS_CORETEAM_MEMBERS="<aif001sdc_coreteam_admin_p080>,<aif001sdc_coreteam_dataops_p081>,<aif001sdc_coreteam_dataops_fabric_p082>" # <mandatory>Core team Entra ID group OIDs<default><aif001sdc_coreteam_admin_p080>,...<ensure> 3 comma-separated AD group ObjectIDs matching personas in PERSONAS_CORE_TEAM.

# PERSONAS (001-010 are reserved for ESML, 011-020 for GenAI-1, 021-030 for GenAI-2, 080-090 for CoreTeam. 100-110 for Service Principals)
PERSONAS_PROJECT_ESML="p001_esml_team_lead,p002_esml_team_member_datascientist,p003_esml_team_member_front_end,p101_esml_team_process_ops" # <optional>ESML project persona list<default>p001_esml_team_lead,...<keep-as-is> 4 personas (3 user, 1 SP). Mapped to GROUPS_PROJECT_MEMBERS_ESML.
PERSONAS_PROJECT_GENAI_1="p011_genai_team_lead,p012_genai_team_member_aifoundry,p013_genai_team_member_agentic,p014_genai_team_member_dataops,p015_genai_team_member_frontend,p102_esml_team_process_ops" # <optional>GenAI-1 project persona list<default>p011_genai_team_lead,...<keep-as-is> 6 personas (5 user, 1 SP). Mapped to GROUPS_PROJECT_MEMBERS_GENAI_1.
PERSONAS_CORE_TEAM="p080_coreteam_it_admin,coreteam_dataops,p081_coreteam_dataops_fabric, p103_coreteam_team_process_ops" # <optional>Core team persona list<default>p080_coreteam_it_admin,...<keep-as-is> 4 personas (3 user, 1 SP). Mapped to GROUPS_CORETEAM_MEMBERS.

# ESML: Azure ML Compute & Performance
ADMIN_AKS_GPU_SKU_DEV_OVERRIDE="Standard_B4ms" # <optional>AKS GPU SKU for DEV<default>Standard_B4ms<keep-as-is> <otherwise> set a different VM size for AKS GPU DEV cluster.
ADMIN_AKS_GPU_SKU_TEST_PROD_OVERRIDE="Standard_DS13-2_v2" # <optional>AKS GPU SKU for TEST/PROD<default>Standard_DS13-2_v2<keep-as-is>
ADMIN_AKS_NODES_DEV_OVERRIDE="1" # <optional>AKS node count for DEV<default>1<keep-as-is>
ADMIN_AKS_NODES_TEST_PROD_OVERRIDE="3" # <optional>AKS node count for TEST/PROD<default>3<keep-as-is>
ADMIN_AKS_VERSION_OVERRIDE="1.33.2" # <optional>AKS Kubernetes version<default>1.33.2<keep-as-is> <otherwise> set the target AKS version for your region.
ADMIN_AML_CLUSTER_MAX_NODES_DEV_OVERRIDE="3" # <optional>AML cluster max nodes for DEV<default>3<keep-as-is>
ADMIN_AML_CLUSTER_MAX_NODES_TEST_PROD_OVERRIDE="5" # <optional>AML cluster max nodes for TEST/PROD<default>5<keep-as-is>
ADMIN_AML_CLUSTER_SKU_DEV_OVERRIDE="Standard_DS3_v2" # <optional>AML cluster VM SKU for DEV<default>Standard_DS3_v2<keep-as-is>
ADMIN_AML_CLUSTER_SKU_TEST_PROD_OVERRIDE="Standard_D13_v2" # <optional>AML cluster VM SKU for TEST/PROD<default>Standard_D13_v2<keep-as-is>
ADMIN_AML_COMPUTE_INSTANCE_DEV_SKU_OVERRIDE="Standard_DS11_v2" # <optional>AML compute instance SKU for DEV<default>Standard_DS11_v2<keep-as-is>
ADMIN_AML_COMPUTE_INSTANCE_TEST_PROD_SKU_OVERRIDE="Standard_ND96amsr_A100_v4" # <optional>AML compute instance SKU for TEST/PROD<default>Standard_ND96amsr_A100_v4<keep-as-is>

# ============================================================================
# EXTRA - EXPERIMENTAL, PLACEHOLDERS, AND DEPRECATED - DONT TOUCH (ONLY CHANGE IF YOU KNOW WHAT YOU ARE DOING)
# ============================================================================

# DEBUG SETTINGS - Error Cleanup Tasks
DEBUG_ENABLE_CLEANING="false" # <optional>Enable error cleanup tasks<default>false<keep-as-is> <otherwise> true, enables cleanup tasks (71-73) that delete resources on deployment failures.

# RETRY SETTINGS - Job Retry Configuration
ENABLE_RETRIES="false" # <optional>Enable automatic job retries<default>false<keep-as-is> <otherwise> true, enables retry logic for GenAI services deployment.
RETRY_MINUTES="5" # <optional>Minutes between 1st and 2nd retry attempt<default>5<keep-as-is>
RETRY_MINUTES_EXTENDED="15" # <optional>Minutes between 2nd and 3rd retry attempt<default>15<keep-as-is>
MAX_RETRY_ATTEMPTS="2" # <optional>Maximum retry attempts<default>2<keep-as-is> Valid values: 1, 2, or 3.
# ============================================================================
# DO NOT TOUCH - PLACEHOLDERS
# ============================================================================
AIFACTORY_SALT_RANDOM="<10>" # <optional>Random salt placeholder (10 chars)<default><10><keep-as-is> Do not change. Placeholder only.

# Description: aifactory_salt:''(default) [5 chars] 
# What: 
#   A deteministic unique value unique for the AIFactory environment. Same for all projects.
# How to find it: 
#   Update with values from AI Factory COMMON Resource group.
#   The aifactory_salt can be read from the AI Factory common resource group in names of services such as Azure Datafactory
#   Example: the 'a4c2b'in 'adf-cmn-weu-dev-a4c2b-001' and in Container registry, private endpoints: 'pend-kv-cmndev-a4c2b-001-to-vnt-esmlcmn'
# Usage: aifactory_salt will be used in Project resource groups 'abcde' for resources such as Managed Identity  'mi-aca-prj001-sdc-dev-abcde19-2858-4a-001'
# ============================================================================
AIFACTORY_SALT="<5>" # <optional>AI Factory deterministic salt (5 chars)<default><5><ensure> read from COMMON RG resource names, e.g. the 'a4c2b' in 'adf-cmn-weu-dev-a4c2b-001'. Used in project resource naming.
ADMIN_IP_FW="" # <optional>Admin IP for firewall rules<default>''<keep-as-is> Used by GHA runner to whitelist its own IP.
# ============================================================================
# DO NOT TOUCH - END
# ============================================================================
# === DEPRECATED-START: AI Foundry / AI Services ===
ENABLE_AI_SERVICES="false"          # <optional>DEPRECATED: Standalone AI Services account<default>false<keep-as-is> Replaced by ENABLE_AI_FOUNDRY. Requires ENABLE_AI_SERVICES:'true' for legacy Hub v1.
ENABLE_AI_FOUNDRY_HUB="false"       # <optional>DEPRECATED: Legacy AI Foundry Hub v1<default>false<keep-as-is> Legacy Hub (v1). Use ENABLE_AI_FOUNDRY instead.
ADD_AI_FOUNDRY_HUB="false"          # <optional>DEPRECATED: Add new legacy Hub v1<default>false<keep-as-is> Add new Hub even if one exists. Use ADD_AI_FOUNDRY instead.
# === DEPRECATED-END ===
# ============================================================================
# EXTRA - END
# ============================================================================
